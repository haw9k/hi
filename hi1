import math


# Чтение матрицы A и вектора B из файла
def read_matrix_and_vector(filename):
    with open(filename, 'r') as f:
        lines = f.readlines()
    A = []
    B = []
    for line in lines:
        values = list(map(float, line.split()))
        A.append(values[:-1])  # Элементы матрицы A
        B.append(values[-1])  # Элементы вектора B
    return A, B


# метод вращений
def givens_rotation(A, B):
    n = len(A)  # Размерность матрицы A
    for i in range(n):
        for j in range(i + 1, n):
            if A[j][i] != 0:
                r = math.sqrt(A[i][i] ** 2 + A[j][i] ** 2)  # Вычисляем радиус(длину вектора)
                c = A[i][i] / r  # Косинус угла поворота
                s = -A[j][i] / r  # Синус угла поворота

                # Поворот строк i и j матрицы A
                for k in range(i, n):
                    temp_i = A[i][k]
                    A[i][k] = c * A[i][k] - s * A[j][k]
                    A[j][k] = s * temp_i + c * A[j][k]

                # Поворот элементов вектора B
                temp_bi = B[i]
                B[i] = c * B[i] - s * B[j]
                B[j] = s * temp_bi + c * B[j]

    # Обратный ход для нахождения решения
    X = [0] * n
    for i in range(n - 1, -1, -1):
        X[i] = B[i]
        for j in range(i + 1, n):
            X[i] -= A[i][j] * X[j]
        X[i] /= A[i][i]

    return X


# Запись результатов в файл
def write_solution(filename, X):
    with open(filename, 'w') as f:
        for x in X:
            f.write(f'{x}\n')


# Основной блок программы
A, B = read_matrix_and_vector('input.txt')  
solution = givens_rotation(A, B)  
write_solution('output.txt', solution)  
"""Метод вращений, также известный как метод Гивенса, — это численный метод решения систем линейных уравнений.
Его основная идея заключается в применении ортогональных матриц для приведения матрицы системы к треугольному виду,
что облегчает дальнейшее решение уравнений методом обратного хода.
В основе метода лежат повороты Гивенса, которые обнуляют элементы под главной диагональю матрицы, применяя вращения в
плоскости. Поворот происходит между двумя строками, чтобы исключить нежелательный элемент. Это делается с помощью так
называемой матрицы Гивенса, которая задаётся синусом и косинусом угла поворота.
КОД:
1. Вычисляем радиус r:Это длина вектора (A[i][i], A[j][i]), которая определяет масштаб поворота.
2. Вычисляем c и s:
c — это косинус угла, он отвечает за проекцию на ось x (направление строки i).
s — это синус угла, он отвечает за проекцию на ось y (направление строки j).
3.Применение поворота: Для каждой строки матрицы A и для каждого элемента в строках i  и j пересчитываются новые
значения на основе формулы поворота:
Новый элемент строки i — это линейная комбинация старых значений элементов строк i и j с коэффициентами c и s.
Новый элемент строки j также обновляется по той же схеме.
Обнуление элемента A[j][i]: После этих вычислений элемент A[j][i] (расположенный под диагональю) становится равным нулю
благодаря тому, что s и c были выбраны так, чтобы обнулить его.
4 1 2 3      
3 5 1 2
1 1 3 4



0.09090909090909081
0.09090909090909094
1.272727272727273
"""
